Here we are interested in steering each agent $i \in \mathcal{V}$ into
resting at a \textit{position} in 3D space, while conforming to the requirements
of the problem; that is, all agents should avoid colliding with each other, all
obstacles in the workspace, and the workspace boundary itself, while remaining
in a non-singular configuration and sustaining the connectivity to their
respective neighbours.


\subsection{The error model}

A desired configuration $\vect{z}_{i,des} \in \mathbb{R}^9 \times \mathbb{T}^3$
is associated to each agent $i \in \mathcal{V}$, with the aim of agent $i$
achieving it in steady-state:
$\lim\limits_{t \to \infty} \|\vect{z}_i(t) - \vect{z}_{i,des}\| = 0$. The
interior of this expression denotes the state error of agent $i$:

$$\vect{e}_i(t) = \vect{z}_i(t) - \vect{z}_{i,des}, \vect{e}_i(t) :
\mathbb{R}_{\geq 0} \to \mathbb{R}^9 \times \mathbb{T}^3$$

The error dynamics are denoted by $g_i(\vect{e}_i, \vect{u}_i)$:
\begin{align}
  \dot{\vect{e}}_i(t) = \dot{\vect{z}}_i(t) - \dot{\vect{z}}_{i,des} =
  \dot{\vect{z}}_i(t) = f_i(\vect{z}_i(t), \vect{u}_i(t)) = g_i(\vect{e}_i(t), \vect{u}_i(t))
  \label{eq:position_based_error_model}
\end{align}
with $\vect{e}_i(0) = \vect{z}_i(0) - \vect{z}_{i,des}$


\subsection{The optimization problem}

At a generic time $t_0$, agent $i$ solves the following optimization problem:

\begin{align}
  \min\limits_{\overline{\vect{u}}_i (\cdot)}\ &
    J_i \big(\overline{\vect{u}}_i (\cdot);\ \vect{e}_i(t_0)) \triangleq
      \int_{t_0}^{t_0 + T_p} F_i \big(\overline{\vect{e}}_i(\tau), \overline{\vect{u}}_i (\tau)\big) d \tau +
      V_i \big(\overline{\vect{e}}_i (t_0 + T_p)\big) \\
  \text{subject to:} & \\
  & \dot{\overline{\vect{e}}}_i(t) = g_i (\overline{\vect{e}}_i (t), \overline{\vect{u}}_i (t)) \\
  & \overline{\vect{e}}_i (t_0) = \vect{e}_i (t_0) \\
  & \overline{\vect{u}}_i(t) \in \mathcal{U}_i, t \in [t_0, t_0 + T_p)\\
  & \overline{\vect{e}}_i (t) \in \mathcal{E}_i,\ t \in [t_0, t_0 + T_p]\\
  & \overline{\vect{e}}_i (t_0 + T_p) \in \mathcal{E}_i^f \\
  \text{and } \forall t \in [t_0, t_0 + T_p]:& \nonumber \\
  & \|\overline{\vect{p}}_i(t) - \overline{\vect{p}}_j(t)\| > \underline{d}_{ij,a}, \forall j \in \mathcal{R}_i(t) \label{constraint:p_1}\\
  & \|\overline{\vect{p}}_i(t) - \vect{p}_k(t)\| > \underline{d}_{ik,o}, \forall k \in \mathcal{K} \\
  & \|\overline{\vect{p}}_i(t)\| + r_i < r_W \\
  & \|\overline{\vect{p}}_i(t) - \overline{\vect{p}}_j(t)\| < d_i, \forall j \in \mathcal{N}_i \\
  & \overline{\theta}_i(t) \ne \pm \frac{\pi}{2} \label{constraint:p_5}
\end{align}\\
Constraints \ref{constraint:p_1}-\ref{constraint:p_5} explicitly address the
requirements posed by the problem \eqref{problem}, while the rest exist to
ensure that formation is achieved under constrained states and input signals.

The functions
$F_i : \mathcal{E}_i \times \mathcal{U}_i \to \mathbb{R}_{\geq 0}$ and
$V_i: \mathcal{E}_i^f \to \mathbb{R}_{\geq 0}$ are defined as
\begin{align}
  F_i (\vect{e}_i, \vect{u}_i)
    &\triangleq \| \vect{e}_i\|_{\mat{Q}_i}^2 + \| \vect{u}_i\|_{\mat{R}_i}^2 \\
  V_i (\vect{e}_i)
    & \triangleq \| \vect{e}_i \|_{\mat{P}_i}^2
\end{align}\\
Matrices $\mat{R}_i \in \mathbb{R}^{6 \times 6}$ are symmetric and positive
definite, while matrices $\mat{Q}_i, \mat{P}_i \in \mathbb{R}^{12 \times 12}$
are symmetric and positive semi-definite.

The set $\mathcal{E}_i$ is such that
$$\mathcal{E}_i = \{\vect{e}_i \in \mathbb{R}^{12} : \vect{e}_i \in \mathcal{Z}_i \oplus (-z_{i,des} )\}$$

The set $\mathcal{E}_i^f \subseteq \mathcal{E}_i$ is an admissible positively
invariant set \note{?? define it} for system \eqref{eq:position_based_error_model}
such that

\begin{align}
  \mathcal{E}_i^f = \{\vect{e}_i \in \mathcal{E}_i : \|\vect{e}_i\| \leq \epsilon_0 \}
\end{align}
where $\epsilon_0$ is an arbitrarily small but fixed positive real scalar.


\begin{gg_box}
\begin{assumption} (Functions $g_i$ are Lipschitz continuous)
  \label{ass:g_i_Lipschitz}
\end{assumption}
\end{gg_box}

\begin{gg_box}
\begin{assumption} (Functions $F_i$ are Lipschitz continuous)
  \label{ass:F_i_Lipschitz}
\end{assumption}
\end{gg_box}


\begin{gg_box}
\begin{assumption} (Functions $V_i$ are Lipschitz continuous)
  \label{ass:V_i_Lipschitz}
\end{assumption}
\end{gg_box}
